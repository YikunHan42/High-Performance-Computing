# OpenMP数据环境
## 数据环境
定义：线程执行一个区域时可见的变量集
	变量：是地址的名称

OpenMP线程可以访问共享+私有的的地址空间
私有、共享的定义

## 堆和栈
内存布局下，两种内存管理方式
 + 栈：系统自动分配释放，存放参数值、局部变量
 + 堆：程序员分配释放，不释放时由OS回收`malloc`

### 区别
内存上：堆容易产生内存泄漏（程序不退出时内存无法再被引用）
空间大小：每个进程拥有栈的大小远小于堆的大小
生长方向：堆的内存地址由低到高，栈反之
分配方式：堆都是动态分配，栈则是静态/动态分配
分配效率不同：专门的寄存器存放栈的地址，堆需要库函数或运算符完成申请或管理，频繁的内存申请容易产生内存碎片
存放内存不同：具体存放内容由操作系统管理/程序员决定

## 缺省存储属性
+ 进程包括一个或多个线程，堆中变量对所有线程都是可见的，共享
+ 并行区域前声明的变量是共享的
+ 全局范围变量在线程之间是共享的
+ 变量出现在线程的栈上，对于该线程来说，就是私有的

## 修改存储属性
### shared子句
+ 语法：shared(list)
+ 编程时将共享变量和`shared`一同列出来是良好习惯
+ 出错的主要原因之一是丢失了不同区域变量的存储属性


### private子句
创建同名同类型，地址不同，但未初始化的新变量，**初始化是要付出代价和开销的**，对各线程是私有的，生命周期在线程内部


### firstprivate子句
+ 初始化与原来值相同，通过复制相应的原始变量来初始化
+ 除非必须使用`firstprivate`，一般都使用`private`

### default子句
+ 语法：`default(none)`
+ 构造体上使用时，区域内所有变量都必须明确地列在`private`,`firstprivate`,`reduction`或`shared`字句

## 数组和指针
+ 静态数组
+ 动态数组

## 曼德勃罗的面积
分形
$$y=x^2+c,c=a+bi$$

![](https://cdn.jsdelivr.net/gh/YikunHan42/Image-Host/202204120901673.png)
$$Z_{n+1}=Z_n^2+c,Z_0=0$$
所有满足函数值不发散的c点，即为曼德勃罗集，具有很强的自相似性
![](https://cdn.jsdelivr.net/gh/YikunHan42/Image-Host/202204120905137.png)
茱莉亚集：$Z_0$

+ 收敛点都落在圆心为原点，半径为2的圆内
+ 曼德勃罗集落在区间[-2,0.5]X[-1.125,1.125]内部
+ 曼德勃罗集关于X轴是对称的

一定不满足的条件：$|z|>4$ 迭代次数要够大，比如$n=1000$

